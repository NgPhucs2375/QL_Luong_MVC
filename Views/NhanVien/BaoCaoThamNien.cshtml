@model List<QL_Luong_MVC.ViewModel.ThamNienViewModel>
@{
    ViewBag.Title = "Vinh danh Thâm niên";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="container-fluid py-4 fade-in-content">

    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card border-left-wine shadow h-100 py-2" style="border-left: 4px solid #722F37;">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h4 class="font-weight-bold text-dark" style="font-family: 'Playfair Display', serif;">
                            <i class="fas fa-medal text-warning mr-2"></i> Bảng vàng Thâm niên
                        </h4>
                        <p class="text-muted mb-0 small">Ghi nhận đóng góp của nhân viên dựa trên thời gian công tác.</p>
                    </div>
                    <div class="text-right">
                        <span class="badge badge-pill badge-success px-3 py-2" style="font-size: 1rem;">
                            <i class="fas fa-user-check mr-1"></i> @ViewBag.SoNguoiTren5Nam Cống hiến (>5 năm)
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow mb-4 border-0" style="border-radius: 12px;">
        <div class="card-header py-3 bg-white border-bottom-0">
            <h6 class="m-0 font-weight-bold" style="color: #4A192C;">Xếp hạng nhân sự</h6>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0 align-middle" id="dataTableThamNien">
                    <thead style="background-color: #722F37; color: white;">
                        <tr>
                            <th class="text-center">Hạng</th>
                            <th>Nhân viên</th>
                            <th>Phòng ban</th>
                            <th>Ngày gia nhập</th>
                            <th>Thâm niên</th>
                            <th>Cấp độ</th>
                            <th class="text-right">Thưởng đề xuất</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int rank = 1; }
                        @foreach (var item in Model)
                        {
                            // Logic màu sắc Badge
                            string badgeClass = "badge-secondary";
                            string icon = "";

                            if (item.SoThangLamViec >= 60)
                            {
                                badgeClass = "badge-warning text-dark border border-warning"; // Vàng (Cống hiến)
                                icon = "<i class='fas fa-crown text-warning mr-1'></i>";
                            }
                            else if (item.SoThangLamViec >= 36)
                            {
                                badgeClass = "badge-info text-white"; // Xanh (Senior)
                                icon = "<i class='fas fa-star text-white mr-1'></i>";
                            }
                            else if (item.SoThangLamViec >= 12)
                            {
                                badgeClass = "badge-success text-white"; // Xanh lá (Junior)
                            }

                            <tr style="@(rank <= 3 ? "background-color: #fffaf0;" : "")">
                                <td class="text-center font-weight-bold text-gray-500">
                                    @if (rank == 1)
                                    {<i class="fas fa-trophy text-warning fa-lg"></i> }
                                    else
                                    { <span>#@rank</span>}
                                </td>
                                <td>
                                    <div class="font-weight-bold text-dark">@item.HoTen</div>
                                    <div class="small text-muted">@item.TenCV</div>
                                </td>
                                <td>@item.TenPB</td>
                                <td>@item.NgayGiaNhap.ToString("dd/MM/yyyy")</td>
                                <td>
                                    <span class="font-weight-bold text-dark">@item.HienThiThoiGian</span>
                                </td>
                                <td>
                                    <span class="badge @badgeClass px-2 py-1" style="font-size: 0.85rem;">
                                        @Html.Raw(icon) @item.CapDo
                                    </span>
                                </td>
                                <td class="text-right font-weight-bold text-success">
                                    @item.ThuongDeXuat.ToString("N0") ₫
                                </td>
                            </tr>
                            rank++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $('#dataTableThamNien').DataTable({
            "language": { "url": "//cdn.datatables.net/plug-ins/1.10.21/i18n/Vietnamese.json" },
            "pageLength": 20,
            "ordering": true
        });
    });
</script>